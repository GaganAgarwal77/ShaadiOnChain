{"version":3,"sources":["app/SentProposals.js","app/services/utility.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js"],"names":["i","Market","push","useHistory","useState","engageProposals","setEngageProposals","hasSentMarriageProposal","setHasSentMarriageProposal","name","proposalId","image","note","status","marriageProposal","setMarriageProposal","useEffect","fetchEngageProposals","loadAccount","myAddress","getAllEngagementProposals","forEach","proposal","index","object","proposer","getUser","proposee","user","getImageFromTokenId","proposerRingTokenId","engageProposal","id","proposerNote","arr","fetchMarriageProposal","getMarriageProposalByUser","vows","proposerVows","console","log","className","map","onClick","src","alt","length","substring","type","getURI","tokenId","tokenURI","uri","slice","uriToImageConverter","axios","result","data","getMetadataFromTokenId","getLoveLetterImageFromTokenId","tokenURILoveLetter","cid","getMarriageCertURI","marriageCertificateTokenURI","getImageFromMarriageCertTokenId","getTreeImageFromTokenId","tokenURITree","getImageFromCID","dataURItoBlob","dataURI","byteString","atob","split","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","Blob","getGeneralContractURI","tokenUri","getMetadataFromGeneralContractTokenUri","tokenUriCID","_toConsumableArray","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","Object","from","unsupportedIterableToArray","TypeError"],"mappings":"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","file":"static/js/24.33e27ce4.chunk.js","sourcesContent":["import React , { useState, useEffect } from 'react'\nimport  '../assets/Market.css'\nimport  '../assets/Card.css'\nimport { useHistory } from 'react-router-dom'\nimport { loadAccount, getUser, getAllEngagementProposals, getMarriageProposalByUser } from \"./services/web3\";\nimport { getImageFromTokenId } from \"./services/utility\";\n\n\nfunction Market() {\n    \n    const { push } = useHistory()\n    const [engageProposals, setEngageProposals] = useState([]);\n    const [hasSentMarriageProposal, setHasSentMarriageProposal] = useState(false);\n    const [marriageProposal, setMarriageProposal] = useState({\n        name: \"\",\n        proposalId: \"\",\n        image: \"\",\n        note: \"\",\n        status: \"\",\n    });\n\n    useEffect(() => {\n        const fetchEngageProposals = async () => {\n            const myAddress = await loadAccount();\n            const engagementProposals = await getAllEngagementProposals();\n            engagementProposals.forEach(async function(proposal, index, object) {\n                if (proposal.proposer !== myAddress) {\n                    return;\n                }\n                const user = await getUser(proposal.proposee);\n                const image = await getImageFromTokenId(proposal.proposerRingTokenId);\n    \n                const engageProposal = {\n                    name: user.name,\n                    proposalId: proposal.id,\n                    image: image,\n                    note: proposal.proposerNote,\n                    status: proposal.status,\n                }\n                setEngageProposals((arr) => [...arr, engageProposal]);\n              });\n        };\n\n        const fetchMarriageProposal = async () => {\n            const myAddress = await loadAccount();\n            const proposal = await getMarriageProposalByUser();\n            if (proposal === false) {\n                return;\n            }\n            if (proposal.proposer !== myAddress) {\n                return;\n            }\n            const user = await getUser(proposal.proposer);\n\n            const marriageProposal = {\n                name: user.name,\n                proposalId: proposal.id,\n                vows: proposal.proposerVows,\n                status: proposal.status,\n            }\n            setMarriageProposal(marriageProposal);\n            setHasSentMarriageProposal(true);\n            console.log(marriageProposal);\n        };\n\n        fetchEngageProposals();\n        fetchMarriageProposal();\n    },[])\n    \n\n    return (\n        <div>\n        <h2>Engagement Proposals</h2>\n        <div className='market'> \n                {engageProposals.map((proposal) => (\n                    <div className='newcard' onClick={() => push('/sent-engagement-proposal/' + proposal.proposalId)} >\n                        <img src={proposal.image} alt=\"Ring NFT\" />\n                        <div className=\"newcard__info\">\n                            <h2>{proposal.name}</h2>\n                            <h4>{proposal.note.length >= 100 ? proposal.note.substring(0, 100) + '...' : proposal.note}</h4>\n                        </div>\n                        <div className='newcard__infoValueParent'>\n                            <div className=\"newcard__infoValue\">\n                                {proposal.status === \"0\" && <button type=\"button\" className=\"btn btn-warning\">Waiting</button>}\n                                {proposal.status === \"1\" && <button type=\"button\" className=\"btn btn-success\">Accepted</button>}\n                                {proposal.status === \"2\" && <button type=\"button\" className=\"btn btn-danger\">Rejected</button>}\n                            </div>\n                        </div>\n                    </div>\n                ))\n                }\n        </div>\n\n        <h2>Marriage Proposals</h2>\n\n        <div className='market'> \n        {\n            hasSentMarriageProposal &&\n            (\n                <div className='newcard' onClick={() => push('/sent-marriage-proposal/' + marriageProposal.proposalId)}>\n                <img src='/assets/images/certificate.jpeg' alt=\"nft artwork\" />\n                <div className=\"newcard__info\">\n                    <h2>{marriageProposal.name}</h2>\n                    <h4>{marriageProposal.vows.length >= 100 ? marriageProposal.vows.substring(0, 100) + '...' : marriageProposal.vows}</h4>\n                </div>\n                <div className='newcard__infoValueParent'>\n                    <div className=\"newcard__infoValue\">\n                        {marriageProposal.status === \"0\" && <button type=\"button\" className=\"btn btn-warning\">Waiting</button>}\n                        {marriageProposal.status === \"1\" && <button type=\"button\" className=\"btn btn-success\">Accepted</button>}\n                        {marriageProposal.status === \"2\" && <button type=\"button\" className=\"btn btn-danger\">Rejected</button>}\n                    </div>\n                </div>\n                </div>\n            )\n        }\n        </div>\n        </div>\n    )\n}\n\nexport default Market;","import { tokenURI, tokenURILoveLetter, marriageCertificateTokenURI, tokenURITree } from \"./web3\";\nimport axios from 'axios';\n\nexport const getURI = async (tokenId) => {\n    var uri = await tokenURI(tokenId);\n    uri = uri.slice(7); \n    uri = uri.substring(0, uri.length - 14);\n    uri = 'https://' + uri + '.ipfs.dweb.link/metadata.json';\n    return uri\n}  \n\nexport const uriToImageConverter = (uri) => {\n    var image = uri.slice(7); \n    image = image.substring(0, image.length - 5);\n    image = 'https://' + image + '.ipfs.dweb.link/blob';\n    return image;\n}\n\nexport const getImageFromTokenId = async (tokenId) => {\n    const uri = await getURI(tokenId);\n    const result = await axios(uri);\n    const image = uriToImageConverter(result.data.image);\n    return image;\n}\n\nexport const getMetadataFromTokenId = async (tokenId) => {\n    const uri = await getURI(tokenId);\n    const result = await axios(uri);\n    return result.data;\n}\n\nexport const getLoveLetterImageFromTokenId = async (tokenId) => {\n    var cid = await tokenURILoveLetter(tokenId);\n    const image = 'https://' + cid + '.ipfs.dweb.link';\n    return image;\n}\n\nexport const getMarriageCertURI = async (tokenId) => {\n    var uri = await marriageCertificateTokenURI(tokenId);\n    uri = uri.slice(7); \n    uri = uri.substring(0, uri.length - 14);\n    uri = 'https://' + uri + '.ipfs.dweb.link/metadata.json';\n    return uri\n}  \n\nexport const getImageFromMarriageCertTokenId = async (tokenId) => {\n    const uri = await getMarriageCertURI(tokenId);\n    const result = await axios(uri);\n    const image = uriToImageConverter(result.data.image);\n    return image;\n}\n\nexport const getTreeImageFromTokenId = async (tokenId) => {\n    const cid = await tokenURITree(tokenId);\n    const image = getImageFromCID(cid);\n    return image;\n}\n\nexport const dataURItoBlob = (dataURI) => {\n    var byteString = atob(dataURI.split(',')[1]);\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n    for (var i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n    var bb = new Blob([ab], {type:'image/*'});\n    return bb;\n}\n\nexport const getGeneralContractURI = async (tokenUri) => {\n    var uri = tokenUri;\n    uri = uri.slice(7); \n    uri = uri.substring(0, uri.length - 14);\n    uri = 'https://' + uri + '.ipfs.dweb.link/metadata.json';\n    return uri\n  }  \n    \nexport const getMetadataFromGeneralContractTokenUri = async (tokenUri) => {\n    const uri = await getGeneralContractURI(tokenUri);\n    const result = await axios(uri);\n    return result.data;\n}\n  \nexport const getImageFromCID = (tokenUriCID) => {\n    return 'https://' + tokenUriCID + '.ipfs.dweb.link';\n}  ","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}"],"sourceRoot":""}